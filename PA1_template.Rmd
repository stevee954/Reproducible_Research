---
title: 'Reproducible Research- Peer-graded Assignment: Course Project 1'
author: "Steve Ellison"
date: "December 1, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Reproducible Research-graded Assignment: Course Project 1

This assignment makes use of data from a personal activity monitoring device. This device collects data at 5 minute intervals through out the day. The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day.  Read statement and summary of initial file:

```{r}
act1 <- read.csv("activity.csv", header=TRUE)
summary(act1)
```
From the above we see 2304 NA values, so we need to impute the missing values. There are lots of ways to do it.  I checked MICE and that was interesting although i did not fully understand what it was doing, so i chose instead to use the IMPUTE statement that is part of HMISC package  and inmpute the MEAN for missing values.  Also I used LUBRIDATE package to format the date into DOW (day of week) for reporting purposes. Here is the code i used to transform act1 :

```{r}
library(Hmisc)

act1$steps2 <- with(act1, impute(steps, mean))

library(lubridate)

act1$dow<-wday(act1$date,label=TRUE)

```

New summary of act1. Imputed column 'steps2' does not have any missing values:


```{r}
summary(act1)
```


The first part of what follows shows the views without imputed values.  Second part is views with the imputed values.  I conclude with an assessment of the impact of non-imputed vs imputed views.

Note:  Instead of creating two datasets as indicated in the instructions I chose to simpy add column "steps2" with the imputed values to the original dataset.

## Views WITHOUT Imputed Missing Values


```{r}
barplot(with(act1,tapply(steps, date, sum)),main="Total Steps Each Day")
```


Mean number of steps each day of week:


```{r}
with(act1,round(tapply(steps,dow, mean,na.rm=TRUE),digits=2))
```


Median number of steps each day of week:

```{r}
with(act1,round(tapply(steps,dow, median,na.rm=TRUE),digits=2))
```



```{r}
barplot(with(act1,round(tapply(steps, date, mean),digits=2)),main="Average (mean) Steps Taken Each Day")
```


```{r}
barplot(with(act1,round(tapply(steps, date, median),digits=2)),main="Median (the most common) Number of Steps Taken Each Day")
```


The 5-minute interval that, on average, contains the maximum number of steps:


```{r}
avg_int<-with(act1,round(tapply(steps, interval, mean)), digits=2)
df<-data.frame(avg_int)
subset(df,avg_int==max(avg_int))
```


## Views WITH Imputed Missing Values



```{r}
barplot(with(act1,tapply(steps2, date, sum)),main="Total Steps Each Day")
```


Mean number of steps each day of week:


```{r}
with(act1,round(tapply(steps2, dow, mean),digits=2))
```


Median number of steps each day of week:

```{r}
with(act1,tapply(steps2, dow, median))
```



```{r}
barplot(with(act1,round(tapply(steps2, date, mean),digits=2)),main="Average (mean) Steps Taken Each Day")
```


```{r}
barplot(with(act1,round(tapply(steps2, date, median),digits=2)),main="Median (the most common) Number of Steps Taken Each Day")
```


The 5-minute interval that, on average, contains the maximum number of steps:


```{r}
avg_int<-with(act1,round(tapply(steps2, interval, mean)), digits=2)
df<-data.frame(avg_int)
subset(df,avg_int==max(avg_int))
```


## Assessment of Impact of Imputed Values


Mean Steps per interval per day WITHOUT imputed Values:

   Sun   Mon   Tue   Wed   Thu   Fri   Sat   
 42.63 34.63 31.07 40.94 28.52 42.92 43.53  


Mean Steps per interval per  day WITH imputed Values:

   Sun   Mon   Tue   Wed   Thu   Fri   Sat   
 41.97 35.25 31.07 40.54 29.50 41.69 42.76  


###The average daily impact was in all cases less than one step, so imputing did not distort the actual results to a significant degree.  I view this as a positive outcome.